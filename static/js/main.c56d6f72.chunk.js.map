{"version":3,"sources":["withRoot.jsx","endpoints.jsx","postForm.jsx","utils.jsx","vote.jsx","post.jsx","orderingForm.jsx","feed.jsx","app.jsx","index.js"],"names":["theme","createMuiTheme","typography","useNextVariants","palette","primary","light","main","dark","contrastText","secondary","withRoot","Component","props","CssBaseline","PostsBase","PostsURL","GetRequestOptions","method","redirect","PostHeaderOptions","withStyles","form","flexGrow","button","margin","spacing","textField","padding","classes","user","onSend","React","useState","text","setText","done","setDone","error","setError","hasError","handleSend","msg","headers","body","JSON","stringify","Date","now","fetch","then","response","ok","json","catch","className","TextField","id","multiline","rowsMax","fullWidth","value","onKeyPress","ev","key","preventDefault","onChange","event","target","Button","variant","disabled","onClick","color","endIcon","Typography","VoteSum","votes","Object","entries","map","up","reduce","s","root","marginLeft","icon","width","height","display","marginRight","justifyContent","alignItems","post","flatVotes","data","undefined","foundVote","find","v","vote","setVote","votesBase","handleVote","url","Error","cVote","parse","time","console","log","updateVote","name","initialVote","upcolor","downcolor","voteSum","Avatar","IconButton","aria-label","size","box","Grid","item","xs","sm","lg","Paper","square","elevation","formControl","minWidth","ordering","orderings","menus","o","MenuItem","FormControl","InputLabel","shrink","Select","labelId","found","possibleOrderings","Feed","state","handleOrderChange","setState","this","prevProps","update","refresh","setData","SortedPosts","sort","lhs","rhs","lvotes","i","container","TrompeteIcon","role","style","App","refreshFeed","AppBar","position","Toolbar","flex","ui","prevState","ReactDOM","render","document","querySelector"],"mappings":"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","file":"static/js/main.c56d6f72.chunk.js","sourcesContent":["import React from 'react';\r\nimport { MuiThemeProvider, createMuiTheme } from '@material-ui/core/styles';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\n\r\n// A theme with custom primary and secondary color.\r\n// It's optional.\r\nconst theme = createMuiTheme({\r\n  typography: {\r\n    useNextVariants: true,\r\n  },\r\n  palette: {\r\n    primary: {\r\n      light: \"#99d066\",\r\n      main: \"#689f38\",\r\n      dark: \"#387002\",\r\n      contrastText: '#000'\r\n    },\r\n    secondary: {\r\n      light: \"#819ca9\",\r\n      main: \"#546e7a\",\r\n      dark: \"#29434e\",\r\n      contrastText: '#fff'\r\n    },\r\n  },\r\n});\r\n\r\nfunction withRoot(Component) {\r\n  function WithRoot(props) {\r\n    // MuiThemeProvider makes the theme available down the React tree\r\n    // thanks to React context.\r\n    return (\r\n      <MuiThemeProvider theme={theme}>\r\n        {/* CssBaseline kickstart an elegant, consistent, and simple baseline to build upon. */}\r\n        <CssBaseline />\r\n        <Component {...props} />\r\n      </MuiThemeProvider>\r\n    );\r\n  }\r\n\r\n  return WithRoot;\r\n}\r\n\r\nexport default withRoot;\r\n","export const PostsBase = 'https://lagerjodel.firebaseio.com/databases/posts';\r\nexport const PostsURL = PostsBase + '.json';\r\nexport const GetRequestOptions = {\r\n  method: 'GET',\r\n  redirect: 'follow'\r\n};\r\n\r\nexport const PostHeaderOptions = {\r\n  'Content-Type': 'application/json',\r\n  'Accept': 'application/json'\r\n}\r\n","import React from 'react';\r\n\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Button from '@material-ui/core/Button';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\nimport SendIcon from '@material-ui/icons/Send';\r\nimport DoneIcon from '@material-ui/icons/Done';\r\n\r\nimport { PostsURL, PostHeaderOptions } from './endpoints';\r\n\r\nconst styles = theme => ({\r\n  form: {\r\n    flexGrow: 1,\r\n  },\r\n  button: {\r\n    margin: theme.spacing(1),\r\n  },\r\n  textField: {\r\n    flexGrow: 1,\r\n    padding: theme.spacing(2),\r\n  },\r\n});\r\n\r\nconst PostForm = (props) => {\r\n  const { classes, user, onSend } = props;\r\n  const [text, setText] = React.useState('');\r\n  const [done, setDone] = React.useState(false);\r\n  const [error, setError] = React.useState(\"Leere Trompete\");\r\n  const hasError = error !== \"\"\r\n\r\n  const wrappedOnSend = () => {\r\n    onSend();\r\n  };\r\n\r\n  const handleSend = () => {\r\n    if (hasError) return;\r\n\r\n    const msg = {\r\n      method: 'POST',\r\n      headers: PostHeaderOptions,\r\n      body: JSON.stringify({\r\n        'user': user,\r\n        'text': text,\r\n        'time': Date.now()\r\n      }),\r\n      redirect: 'follow'\r\n    };\r\n    fetch(PostsURL, msg)\r\n      .then((response) => {\r\n        if (response.ok) {\r\n          response.json().then((json) => {\r\n            setDone(true);\r\n            setText(\"\");\r\n            wrappedOnSend();\r\n          }).catch(() => {\r\n            setError(\"Fehler beim Verarbeiten der Nachricht...\");\r\n          });\r\n        }\r\n        else {\r\n          setError(\"Mein Server mag diese Nachricht nicht...\");\r\n        }\r\n      })\r\n      // this would recover the error message\r\n      //.then( data => setError(\"sending failed...\" + data.errors[0].msg))\r\n      .catch(() => {\r\n        setError(\"Fehler beim Senden der Nachricht...\");\r\n      });\r\n  };\r\n\r\n  const handleChange = (event) => {\r\n    if (done) {\r\n      setDone(false);\r\n    }\r\n    setText(event.target.value);\r\n    setError(event.target.value ? \"\" : \"Leere Trompete\");\r\n  };\r\n\r\n  return <form className={classes.form}>\r\n    <TextField\r\n      id=\"my-text\"\r\n      multiline\r\n      error={hasError}\r\n      className={classes.textField}\r\n      rowsMax={4}\r\n      fullWidth\r\n      value={text}\r\n      onKeyPress={(ev) => {\r\n        if (ev.key === 'Enter') {\r\n          handleSend();\r\n          ev.preventDefault();\r\n        }\r\n      }}\r\n      onChange={handleChange}\r\n    />\r\n    <Button\r\n      variant=\"contained\"\r\n      disabled={done || hasError}\r\n      onClick={handleSend}\r\n      className={classes.button}\r\n      color={done ? \"secondary\" : \"primary\"}\r\n      endIcon={done ? <DoneIcon /> : <SendIcon />}>\r\n      Send\r\n          </Button>\r\n    {done ? <Typography variant=\"body1\" color=\"primary\">Gesendet!</Typography> : \"\"}\r\n  </form>\r\n};\r\n\r\nexport default withStyles(styles)(PostForm);\r\n","export function VoteSum(votes) {\r\n  if (votes) {\r\n    const ups = Object.entries(votes).map(\r\n      ([, v]) => { return v.up });\r\n    return ups.reduce((s, up) => s + (up ? 1 : -1), 0);\r\n  }\r\n  return 0;\r\n}\r\n","import React from 'react';\r\n\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\nimport ArrowUpwardIcon from '@material-ui/icons/ArrowUpward';\r\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\r\n\r\nimport { PostsBase, PostHeaderOptions } from './endpoints';\r\nimport { VoteSum } from './utils';\r\n\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    marginLeft: 'auto',\r\n  },\r\n  icon: {\r\n    width: theme.spacing(3),\r\n    height: theme.spacing(3),\r\n    display: 'block',\r\n    marginLeft: 'auto',\r\n    marginRight: 'auto',\r\n  },\r\n  votes: {\r\n    height: '100%',\r\n    display: 'flex',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  }\r\n});\r\n\r\nconst Votes = (props) => {\r\n  const { id, post, user, classes } = props;\r\n  const { votes } = post;\r\n  const flatVotes = votes ? Object.entries(votes).map(\r\n    ([k, v]) => { return { id: k, data: v } }) : undefined;\r\n  const foundVote = flatVotes ? flatVotes.find(v => v.data.user === user) : undefined;\r\n\r\n  const [vote, setVote] = React.useState(foundVote);\r\n\r\n  const votesBase = PostsBase + '/' + id + '/votes';\r\n\r\n\r\n  const initialVote = (up) => {\r\n    const url = votesBase + '.json';\r\n    const data = {\r\n      'user': user,\r\n      'up': up,\r\n      'time': Date.now()\r\n    }\r\n    const msg = {\r\n      method: 'POST',\r\n      headers: PostHeaderOptions,\r\n      body: JSON.stringify({\r\n        'user': user,\r\n        'up': up,\r\n        'time': Date.now()\r\n      }),\r\n      redirect: 'follow'\r\n    };\r\n    fetch(url, msg)\r\n      .then((response) => {\r\n        if (response.ok) {\r\n          response.json().then((json) => {\r\n            setVote({\r\n              data: data,\r\n              id: json.name\r\n            });\r\n          });\r\n        }\r\n        else {\r\n          throw new Error(\"Whoops!\");\r\n        }\r\n      })\r\n      .catch(() => {\r\n        console.log(\"Fehler beim Senden des Votes...\");\r\n      });\r\n  }\r\n\r\n  const updateVote = (up) => {\r\n    const url = votesBase + '/' + vote.id + '/.json';\r\n    const msg = {\r\n      method: 'PATCH',\r\n      headers: PostHeaderOptions,\r\n      body: JSON.stringify({\r\n        'up': up,\r\n        'time': Date.now()\r\n      }),\r\n      redirect: 'follow'\r\n    };\r\n    fetch(url, msg)\r\n      .then((response) => {\r\n        if (response.ok) {\r\n          response.json().then((json) => {\r\n            // deep copy\r\n            const cVote = JSON.parse(JSON.stringify(vote))\r\n            cVote.data.up = json.up;\r\n            cVote.data.time = json.time;\r\n            setVote(cVote);\r\n          });\r\n        }\r\n        else {\r\n          throw new Error(\"Whoops!\");\r\n        }\r\n      })\r\n      .catch(() => {\r\n        console.log(\"Fehler beim Senden des Votes...\");\r\n      });\r\n  }\r\n\r\n  const handleVote = (up) => {\r\n    if (vote) {\r\n      updateVote(up);\r\n    }\r\n    else {\r\n      initialVote(up);\r\n    }\r\n  };\r\n\r\n  const handleUpVote = (event) => {\r\n    handleVote(true);\r\n  }\r\n\r\n  const handleDownVote = (event) => {\r\n    handleVote(false);\r\n  }\r\n  let upcolor = \"inherit\";\r\n  let downcolor = \"inherit\";\r\n  let voteSum = VoteSum(votes);\r\n  if (vote) {\r\n    const { up } = vote.data;\r\n    upcolor = up ? \"primary\" : \"inherit\";\r\n    downcolor = !up ? \"primary\" : \"inherit\";\r\n    // correct the voting by the local state\r\n    if (foundVote && foundVote.data.up !== up) {\r\n      voteSum += up ? 2 : -2;\r\n    }\r\n  }\r\n\r\n  return <div className={classes.root}>\r\n    <Avatar className={classes.icon}>\r\n      <Typography variant=\"caption\" className={classes.votes}>\r\n        {voteSum}\r\n      </Typography>\r\n    </Avatar>\r\n    <IconButton\r\n      className={classes.icon}\r\n      aria-label=\"upvote\"\r\n      size=\"small\"\r\n      color={upcolor}\r\n      onClick={handleUpVote}>\r\n      <ArrowUpwardIcon />\r\n    </IconButton>\r\n    <IconButton\r\n      className={classes.icon}\r\n      aria-label=\"downvote\"\r\n      size=\"small\"\r\n      color={downcolor}\r\n      onClick={handleDownVote}>\r\n      <ArrowDownwardIcon />\r\n    </IconButton>\r\n  </div>\r\n};\r\n\r\nexport default withStyles(styles)(Votes);\r\n\r\n\r\n","import React from 'react';\r\n\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Paper from '@material-ui/core/Paper';\r\n\r\n\r\nimport Vote from './vote';\r\n\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    flexGrow: 1,\r\n  },\r\n  box: {\r\n    margin: theme.spacing(2),\r\n    padding: theme.spacing(2),\r\n    display: \"flex\",\r\n  },\r\n});\r\n\r\nconst Post = (props) => {\r\n  const { id, post, user, classes } = props;\r\n  const { text } = post;\r\n\r\n  return <Grid item xs={12} sm={6} lg={4} className={classes.root}>\r\n    <Paper square elevation={2} className={classes.box}>\r\n      <Typography variant=\"h6\" color=\"inherit\">\r\n        {text}\r\n      </Typography>\r\n      <Vote post={post} id={id} user={user} />\r\n    </Paper>\r\n  </Grid>\r\n};\r\n\r\nexport default withStyles(styles)(Post);\r\n\r\n","\r\nimport React from 'react';\r\n\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Select from '@material-ui/core/Select';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\n\r\n\r\nconst styles = theme => ({\r\n  formControl: {\r\n    margin: theme.spacing(1),\r\n    minWidth: 120,\r\n  }\r\n});\r\n\r\nconst OrderingForm = (props) => {\r\n  const { classes, onChange, ordering, orderings } = props;\r\n  const { value } = ordering;\r\n\r\n  const menus = orderings.map(o => {\r\n    return <MenuItem value={o.value}>{o.name}</MenuItem>\r\n  });\r\n\r\n  const handleChange = (event) => {\r\n    const { value } = event.target;\r\n    const found = orderings.find(o => value === o.value);\r\n    if (found)\r\n      onChange(found);\r\n  };\r\n\r\n  return <FormControl className={classes.formControl}>\r\n    <InputLabel shrink id=\"ordering-label\">\r\n      sortieren nach\r\n    </InputLabel>\r\n    <Select\r\n      labelId=\"demo-simple-select-placeholder-label-label\"\r\n      id=\"demo-simple-select-placeholder-label\"\r\n      value={value}\r\n      onChange={handleChange}\r\n    >\r\n      {menus}\r\n    </Select>\r\n  </FormControl>\r\n};\r\n\r\nexport default withStyles(styles)(OrderingForm);\r\n","import React from 'react';\r\n\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport Grid from '@material-ui/core/Grid';\r\n\r\nimport Post from './post';\r\nimport OrderingForm from './orderingForm';\r\nimport { PostsURL, GetRequestOptions } from './endpoints';\r\nimport { VoteSum } from './utils';\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    flexGrow: 1,\r\n  },\r\n});\r\n\r\nconst possibleOrderings = [\r\n  { name: \"Neueste\", value: \"newest\" },\r\n  { name: \"Hottest\", value: \"hottest\" },\r\n]\r\n\r\nclass Feed extends React.Component {\r\n  state = {\r\n    data: {},\r\n    error: \"\",\r\n    ordering: possibleOrderings[0]\r\n  }\r\n\r\n  setData(data) {\r\n    this.setState({ data: data });\r\n  }\r\n\r\n  componentDidMount(prevProps) {\r\n    this.update()\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (this.props.refresh !== prevProps.refresh) {\r\n      this.update()\r\n    }\r\n  }\r\n\r\n  handleOrderChange = (ordering) => {\r\n    this.setState({ ordering: ordering });\r\n  }\r\n\r\n  update() {\r\n    // const { user } = this.props;\r\n    fetch(PostsURL, GetRequestOptions).then(response => response.json())\r\n      .then(json => {\r\n        this.setData(json);\r\n      });\r\n  }\r\n\r\n  render() {\r\n    const { user, classes } = this.props;\r\n    const { data, ordering } = this.state;\r\n    const { value } = ordering;\r\n    const FlatPosts = Object.entries(data).map(([k, v]) => { return { id: k, data: v }; });\r\n    const SortedPosts = FlatPosts.sort((lhs, rhs) => {\r\n      if (value === \"newest\") {\r\n        return rhs.data.time - lhs.data.time;\r\n      }\r\n      else if (value === \"hottest\") {\r\n        const lvotes = VoteSum(lhs.data.votes);\r\n        const rvotes = VoteSum(rhs.data.votes);\r\n        const score = rvotes - lvotes;\r\n        return score;\r\n      }\r\n      else {\r\n        return 0;\r\n      }\r\n    }).map((post, i) => {\r\n      return <Post id={post.id} post={post.data} user={user} key={i} />\r\n    });\r\n\r\n    return <Grid className={classes.root} container spacing={1}>\r\n      <Grid item xs={12}>\r\n        <OrderingForm ordering={ordering} orderings={possibleOrderings} onChange={this.handleOrderChange} />\r\n      </Grid>\r\n      {SortedPosts}\r\n    </Grid>\r\n  }\r\n};\r\n\r\nexport default withStyles(styles)(Feed);\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Paper from '@material-ui/core/Paper';\r\n\r\nimport withRoot from './withRoot';\r\nimport PostForm from './postForm';\r\nimport Feed from './feed';\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    flexGrow: 1,\r\n  },\r\n  main: {\r\n    padding: theme.spacing(2),\r\n    margin: theme.spacing(1),\r\n  },\r\n  ui: {\r\n    padding: theme.spacing(2),\r\n    margin: theme.spacing(1),\r\n  },\r\n});\r\n\r\nconst TrompeteIcon = () => { return <span role=\"img\" aria-label=\"trompete\" style={{ margin: \"1ex\" }}>🎺</span>; };\r\n\r\nconst user = '-M8qkGNG5pSfIyxBcxPP';\r\n\r\nclass App extends Component {\r\n\r\n  state = {\r\n    refreshFeed: false\r\n  };\r\n\r\n  render() {\r\n    const { classes } = this.props;\r\n\r\n    const handleSend = () => { this.setState(prevState => { return { refreshFeed: !prevState.refreshFeed } }); };\r\n\r\n    return <div className={classes.root}>\r\n      <AppBar position=\"static\">\r\n        <Toolbar>\r\n          <TrompeteIcon />\r\n          <Typography variant=\"h6\" color=\"inherit\" className={classes.flex}>\r\n            Trompete\r\n          </Typography>\r\n        </Toolbar>\r\n      </AppBar>\r\n      <Paper square elevation={4} className={classes.ui}>\r\n        <Grid container spacing={2}>\r\n          <Grid item xs={12}>\r\n            <PostForm user={user} onSend={handleSend} />\r\n          </Grid>\r\n        </Grid>\r\n      </Paper>\r\n      <Grid container spacing={2} className={classes.main}>\r\n        <Grid item xs={12}>\r\n          <Feed user={user} refresh={this.state.refreshFeed} />\r\n        </Grid>\r\n      </Grid>\r\n    </div >\r\n  }\r\n}\r\n\r\nApp.propTypes = {\r\n  classes: PropTypes.object.isRequired,\r\n};\r\n\r\nexport default withRoot(withStyles(styles)(App));\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './app.jsx';\r\n\r\nReactDOM.render(<App />, document.querySelector('#root'));\r\n"],"sourceRoot":""}