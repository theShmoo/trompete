(this.webpackJsonptrompete=this.webpackJsonptrompete||[]).push([[0],{72:function(e,t,a){e.exports=a(81)},81:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(8),i=a.n(o),c=a(35),s=a(36),l=a(46),u=a(45),m=a(4),d=a(125),f=a(126),h=a(122),p=a(124),v=a(82),g=a(62),b=a(114),E=a(115),y=Object(g.a)({typography:{useNextVariants:!0},palette:{primary:{light:"#99d066",main:"#689f38",dark:"#387002",contrastText:"#000"},secondary:{light:"#819ca9",main:"#546e7a",dark:"#29434e",contrastText:"#fff"}}});var j=function(e){return function(t){return r.a.createElement(b.a,{theme:y},r.a.createElement(E.a,null),r.a.createElement(e,t))}},O=a(13),x=a(128),N=a(121),w=a(59),S=a.n(w),k=a(58),C=a.n(k),G="https://lagerjodel.firebaseio.com/databases/posts",F=G+".json",T={method:"GET",redirect:"follow"},D={"Content-Type":"application/json",Accept:"application/json"},P=Object(m.a)((function(e){return{form:{flexGrow:1},button:{margin:e.spacing(1)},textField:{flexGrow:1,padding:e.spacing(2)}}}))((function(e){var t=e.classes,a=e.user,n=e.onSend,o=r.a.useState(""),i=Object(O.a)(o,2),c=i[0],s=i[1],l=r.a.useState(!1),u=Object(O.a)(l,2),m=u[0],d=u[1],f=r.a.useState("Leere Trompete"),p=Object(O.a)(f,2),v=p[0],g=p[1],b=""!==v,E=function(){if(!b){var e={method:"POST",headers:D,body:JSON.stringify({user:a,text:c,time:Date.now()}),redirect:"follow"};fetch(F,e).then((function(e){e.ok?e.json().then((function(e){d(!0),s(""),n()})).catch((function(){g("Fehler beim Verarbeiten der Nachricht...")})):g("Mein Server mag diese Nachricht nicht...")})).catch((function(){g("Fehler beim Senden der Nachricht...")}))}};return r.a.createElement("form",{className:t.form},r.a.createElement(x.a,{id:"my-text",multiline:!0,error:b,className:t.textField,rowsMax:4,fullWidth:!0,value:c,onKeyPress:function(e){"Enter"===e.key&&(E(),e.preventDefault())},onChange:function(e){m&&d(!1),s(e.target.value),g(e.target.value?"":"Leere Trompete")}}),r.a.createElement(N.a,{variant:"contained",disabled:m||b,onClick:E,className:t.button,color:m?"secondary":"primary",endIcon:m?r.a.createElement(C.a,null):r.a.createElement(S.a,null)},"Send"),m?r.a.createElement(h.a,{variant:"body1",color:"primary"},"Gesendet!"):"")})),J=a(132),q=a(123),I=a(60),M=a.n(I),A=a(61),L=a.n(A);function V(e){return e?Object.entries(e).map((function(e){return Object(O.a)(e,2)[1].up})).reduce((function(e,t){return e+(t?1:-1)}),0):0}var W=Object(m.a)((function(e){return{root:{marginLeft:"auto"},icon:{width:e.spacing(3),height:e.spacing(3),display:"block",marginLeft:"auto",marginRight:"auto"},votes:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}}}))((function(e){var t=e.id,a=e.post,n=e.user,o=e.classes,i=a.votes,c=i?Object.entries(i).map((function(e){var t=Object(O.a)(e,2);return{id:t[0],data:t[1]}})):void 0,s=c?c.find((function(e){return e.data.user===n})):void 0,l=r.a.useState(s),u=Object(O.a)(l,2),m=u[0],d=u[1],f=G+"/"+t+"/votes",p=function(e){m?function(e){var t=f+"/"+m.id+"/.json",a={method:"PATCH",headers:D,body:JSON.stringify({up:e,time:Date.now()}),redirect:"follow"};fetch(t,a).then((function(e){if(!e.ok)throw new Error("Whoops!");e.json().then((function(e){var t=JSON.parse(JSON.stringify(m));t.data.up=e.up,t.data.time=e.time,d(t)}))})).catch((function(){console.log("Fehler beim Senden des Votes...")}))}(e):function(e){var t=f+".json",a={user:n,up:e,time:Date.now()},r={method:"POST",headers:D,body:JSON.stringify({user:n,up:e,time:Date.now()}),redirect:"follow"};fetch(t,r).then((function(e){if(!e.ok)throw new Error("Whoops!");e.json().then((function(e){d({data:a,id:e.name})}))})).catch((function(){console.log("Fehler beim Senden des Votes...")}))}(e)},v="inherit",g="inherit",b=V(i);if(m){var E=m.data.up;v=E?"primary":"inherit",g=E?"inherit":"primary",s&&s.data.up!==E&&(b+=E?2:-2)}return r.a.createElement("div",{className:o.root},r.a.createElement(J.a,{className:o.icon},r.a.createElement(h.a,{variant:"caption",className:o.votes},b)),r.a.createElement(q.a,{className:o.icon,"aria-label":"upvote",size:"small",color:v,onClick:function(e){p(!0)}},r.a.createElement(M.a,null)),r.a.createElement(q.a,{className:o.icon,"aria-label":"downvote",size:"small",color:g,onClick:function(e){p(!1)}},r.a.createElement(L.a,null)))})),z=Object(m.a)((function(e){return{root:{flexGrow:1},box:{margin:e.spacing(2),padding:e.spacing(2),display:"flex"}}}))((function(e){var t=e.id,a=e.post,n=e.user,o=e.classes,i=a.text;return r.a.createElement(p.a,{item:!0,xs:12,sm:6,lg:4,className:o.root},r.a.createElement(v.a,{square:!0,elevation:2,className:o.box},r.a.createElement(h.a,{variant:"h6",color:"inherit"},i),r.a.createElement(W,{post:a,id:t,user:n})))})),B=a(120),H=a(130),K=a(127),R=a(129),U=Object(m.a)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120}}}))((function(e){var t=e.classes,a=e.onChange,n=e.ordering,o=e.orderings,i=n.value,c=o.map((function(e){return r.a.createElement(H.a,{value:e.value},e.name)}));return r.a.createElement(B.a,{className:t.formControl},r.a.createElement(R.a,{shrink:!0,id:"ordering-label"},"sortieren nach"),r.a.createElement(K.a,{labelId:"demo-simple-select-placeholder-label-label",id:"demo-simple-select-placeholder-label",value:i,onChange:function(e){var t=e.target.value,n=o.find((function(e){return t===e.value}));n&&a(n)}},c))})),Q=[{name:"Neueste",value:"newest"},{name:"Hottest",value:"hottest"}],X=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:{},error:"",ordering:Q[0]},e.handleOrderChange=function(t){e.setState({ordering:t})},e}return Object(s.a)(a,[{key:"setData",value:function(e){this.setState({data:e})}},{key:"componentDidMount",value:function(e){this.update()}},{key:"componentDidUpdate",value:function(e){this.props.refresh!==e.refresh&&this.update()}},{key:"update",value:function(){var e=this;fetch(F,T).then((function(e){return e.json()})).then((function(t){e.setData(t)}))}},{key:"render",value:function(){var e=this.props,t=e.user,a=e.classes,n=this.state,o=n.data,i=n.ordering,c=i.value,s=Object.entries(o).map((function(e){var t=Object(O.a)(e,2);return{id:t[0],data:t[1]}})).sort((function(e,t){if("newest"===c)return t.data.time-e.data.time;if("hottest"===c){var a=V(e.data.votes);return V(t.data.votes)-a}return 0})).map((function(e,a){return r.a.createElement(z,{id:e.id,post:e.data,user:t,key:a})}));return r.a.createElement(p.a,{className:a.root,container:!0,spacing:1},r.a.createElement(p.a,{item:!0,xs:12},r.a.createElement(U,{ordering:i,orderings:Q,onChange:this.handleOrderChange})),s)}}]),a}(r.a.Component),Y=Object(m.a)((function(e){return{root:{flexGrow:1}}}))(X),Z=function(){return r.a.createElement("span",{role:"img","aria-label":"trompete",style:{margin:"1ex"}},"\ud83c\udfba")},$=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={refreshFeed:!1},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement("div",{className:t.root},r.a.createElement(d.a,{position:"static"},r.a.createElement(f.a,null,r.a.createElement(Z,null),r.a.createElement(h.a,{variant:"h6",color:"inherit",className:t.flex},"Trompete"))),r.a.createElement(v.a,{square:!0,elevation:4,className:t.ui},r.a.createElement(p.a,{container:!0,spacing:2},r.a.createElement(p.a,{item:!0,xs:12},r.a.createElement(P,{user:"-M8qkGNG5pSfIyxBcxPP",onSend:function(){e.setState((function(e){return{refreshFeed:!e.refreshFeed}}))}})))),r.a.createElement(p.a,{container:!0,spacing:2,className:t.main},r.a.createElement(p.a,{item:!0,xs:12},r.a.createElement(Y,{user:"-M8qkGNG5pSfIyxBcxPP",refresh:this.state.refreshFeed}))))}}]),a}(n.Component),_=j(Object(m.a)((function(e){return{root:{flexGrow:1},main:{padding:e.spacing(2),margin:e.spacing(1)},ui:{padding:e.spacing(2),margin:e.spacing(1)}}}))($));i.a.render(r.a.createElement(_,null),document.querySelector("#root"))}},[[72,1,2]]]);
//# sourceMappingURL=main.c56d6f72.chunk.js.map