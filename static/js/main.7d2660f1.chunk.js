(this.webpackJsonptrompete=this.webpackJsonptrompete||[]).push([[0],{84:function(e,t,a){e.exports=a(95)},95:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(8),c=a.n(o),i=a(39),s=a(40),l=a(51),m=a(50),u=a(4),d=a(135),f=a(136),p=a(132),h=a(134),g=a(97),v=a(70),E=a(124),b=a(125),y=Object(v.a)({typography:{useNextVariants:!0},palette:{primary:{light:"#99d066",main:"#689f38",dark:"#387002",contrastText:"#000"},secondary:{light:"#819ca9",main:"#546e7a",dark:"#29434e",contrastText:"#fff"}}});var j=function(e){return function(t){return r.a.createElement(E.a,{theme:y},r.a.createElement(b.a,null),r.a.createElement(e,t))}},O=a(10),x=a(140),N=a(131),w=a(63),k=a.n(w),S=a(62),C=a.n(S),G="https://lagerjodel.firebaseio.com/databases/posts",T=G+".json",F={method:"GET",redirect:"follow"},P={"Content-Type":"application/json",Accept:"application/json"},D=function(e){var t=e.classes,a=e.user,n=e.onSend,o=e.postid,c=r.a.useState(""),i=Object(O.a)(c,2),s=i[0],l=i[1],m=r.a.useState(!1),u=Object(O.a)(m,2),d=u[0],f=u[1],h=r.a.useState("Leere Trompete"),g=Object(O.a)(h,2),v=g[0],E=g[1],b=""!==v,y=function(){if(!b){var e=o?G+"/"+o+"/comments.json":T,t={user:a,text:s,time:Date.now()},r={method:"POST",headers:P,body:JSON.stringify(t),redirect:"follow"};fetch(e,r).then((function(e){e.ok?e.json().then((function(e){f(!0),l(""),function(e,t){n(e,t)}(e.name,t)})).catch((function(){E("Fehler beim Verarbeiten der Nachricht...")})):E("Mein Server mag diese Nachricht nicht...")})).catch((function(){E("Fehler beim Senden der Nachricht...")}))}};return r.a.createElement("form",{className:t.form},r.a.createElement(x.a,{id:"my-text",multiline:!0,error:b,className:t.textField,rowsMax:4,fullWidth:!0,value:s,onKeyPress:function(e){"Enter"===e.key&&(y(),e.preventDefault())},onChange:function(e){d&&f(!1),l(e.target.value),E(e.target.value?"":"Leere Trompete")}}),r.a.createElement(N.a,{variant:"contained",disabled:d||b,onClick:y,className:t.button,color:d?"secondary":"primary",endIcon:d?r.a.createElement(C.a,null):r.a.createElement(k.a,null)},o?"Antworten":"Trompete!"),d?r.a.createElement(p.a,{variant:"body1",color:"primary"},"Gesendet!"):"")},J=Object(u.a)((function(e){return{form:{flexGrow:1},button:{margin:e.spacing(1)},textField:{flexGrow:1,padding:e.spacing(2)}}}))(D);D.defaultProps={comment:!1};var L=a(139),I=a(69),q=a.n(I),A=a(145),M=a(133),V=a(64),W=a.n(V),z=a(65),B=a.n(z);function K(e){return e?Object.entries(e).map((function(e){return Object(O.a)(e,2)[1].up})).reduce((function(e,t){return e+(t?1:-1)}),0):0}var H=Object(u.a)((function(e){return{root:{paddingLeft:e.spacing(1)},icon:{width:e.spacing(3),height:e.spacing(3),display:"block",marginLeft:"auto",marginRight:"auto"},votes:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}}}))((function(e){var t=e.id,a=e.post,n=e.user,o=e.parent,c=e.classes,i=a.votes,s=i?Object.entries(i).map((function(e){var t=Object(O.a)(e,2);return{id:t[0],data:t[1]}})):void 0,l=s?s.find((function(e){return e.data.user===n})):void 0,m=r.a.useState(l),u=Object(O.a)(m,2),d=u[0],f=u[1],h=o?G+"/"+o+"/comments/"+t+"/votes":G+"/"+t+"/votes",g=function(e){if(d){if(d.id&&d.data.up!==e){var t=JSON.parse(JSON.stringify(d));t.data.up=e,t.data.time=Date.now(),f(t),function(e,t){var a=h+"/"+d.id+"/.json",n={method:"PATCH",headers:P,body:JSON.stringify(e),redirect:"follow"};fetch(a,n).then((function(e){if(!e.ok)throw new Error("Whoops!")})).catch((function(){console.log("Fehler beim Senden des Votes...")}))}(t.data)}}else{var a={user:n,up:e,time:Date.now()};f({data:a}),function(e,t){var a=h+".json",n={method:"POST",headers:P,body:JSON.stringify(e),redirect:"follow"};fetch(a,n).then((function(t){if(!t.ok)throw new Error("Whoops!");t.json().then((function(t){f({data:e,id:t.name})}))})).catch((function(){console.log("Fehler beim Senden des Votes...")}))}(a)}},v="inherit",E="inherit",b=K(i);if(d){var y=d.data.up;v=y?"primary":"inherit",E=y?"inherit":"primary",l?l.data.up!==y&&(b+=y?2:-2):b+=y?1:-1}return r.a.createElement("div",{className:c.root},r.a.createElement(A.a,{className:c.icon},r.a.createElement(p.a,{variant:"caption",className:c.votes},b)),r.a.createElement(M.a,{className:c.icon,"aria-label":"upvote",size:"small",color:v,onClick:function(e){g(!0)}},r.a.createElement(W.a,null)),r.a.createElement(M.a,{className:c.icon,"aria-label":"downvote",size:"small",color:E,onClick:function(e){g(!1)}},r.a.createElement(B.a,null)))})),R=a(66),U=a.n(R),Q=a(67),X=a.n(Q),Y=a(68),Z=a.n(Y)()(X.a),$=function(e){var t=e.time;return r.a.createElement(L.a,{alignSelf:"flex-end"},r.a.createElement(p.a,{variant:"caption",color:"inherit"},r.a.createElement(U.a,{date:t,formatter:Z})))},_=a(54),ee=function(e){var t=e.comment,a=e.user,n=e.postid,o=e.classes,c=t.data,i=c.text,s=c.time;return r.a.createElement(L.a,{display:"flex",className:o.comment},r.a.createElement(L.a,{flexGrow:1},r.a.createElement($,{time:s}),r.a.createElement(p.a,{variant:"body1",color:"inherit"},i)),r.a.createElement(L.a,null,r.a.createElement(H,{post:t.data,id:t.id,parent:n,user:a})))},te=Object(u.a)((function(e){return{root:{flexGrow:1},comment:{borderLeft:"solid black 1px",paddingLeft:e.spacing(1),marginTop:e.spacing(1)}}}))((function(e){var t=e.user,a=e.post,n=e.postid,o=e.classes,c=r.a.useState(a.comments),i=Object(O.a)(c,2),s=i[0],l=i[1],m=(s?Object.entries(s).map((function(e){var t=Object(O.a)(e,2);return{id:t[0],data:t[1]}})):[]).map((function(e){return r.a.createElement(ee,{key:e.id,comment:e,user:t,postid:n,classes:o})}));return r.a.createElement(h.a,{item:!0,sx:12,className:o.root},r.a.createElement(J,{user:t,postid:n,onSend:function(e,t){l(Object(_.a)(Object(_.a)({},s),{},{[e]:t}))}}),m)})),ae=function(e){var t=e.comments,a=e.classes,n=e.onClick,o=t?Object.keys(t).length:0;return r.a.createElement(L.a,{flexGrow:1},r.a.createElement(N.a,{className:a.comment,variant:"text",size:"small",color:"secondary",onClick:n,startIcon:r.a.createElement(q.a,null)},r.a.createElement(p.a,{variant:"caption",color:"inherit"},1===o?o+" Kommentar":o+" Kommentare")))},ne=Object(u.a)((function(e){return{root:{flexGrow:1},box:{margin:e.spacing(1),paddingLeft:e.spacing(2),paddingRight:e.spacing(2),paddingTop:e.spacing(2),paddingBottom:e.spacing(1)},comment:{margin:e.spacing(0),padding:e.spacing(0)}}}))((function(e){var t=e.id,a=e.post,n=e.user,o=e.classes,c=a.text,i=a.time,s=a.comments,l=r.a.useState(!1),m=Object(O.a)(l,2),u=m[0],d=m[1];return r.a.createElement(h.a,{item:!0,xs:12,sm:6,lg:4,className:o.root},r.a.createElement(g.a,{square:!0,elevation:2,className:o.box},r.a.createElement(L.a,{display:"flex"},r.a.createElement(L.a,{flexGrow:1},r.a.createElement(p.a,{variant:"h6",color:"inherit"},c)),r.a.createElement(L.a,null,r.a.createElement(H,{post:a,id:t,user:n}))),r.a.createElement(L.a,{display:"flex"},r.a.createElement(ae,{comments:s,classes:o,onClick:function(e){return d(!u)}}),r.a.createElement($,{time:i})),u?r.a.createElement(te,{post:a,postid:t,user:n}):""))})),re=a(130),oe=a(142),ce=a(137),ie=a(141),se=Object(u.a)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120}}}))((function(e){var t=e.classes,a=e.onChange,n=e.ordering,o=e.orderings,c=n.value,i=o.map((function(e,t){return r.a.createElement(oe.a,{value:e.value,key:t},e.name)}));return r.a.createElement(re.a,{className:t.formControl},r.a.createElement(ie.a,{shrink:!0,id:"ordering-label"},"sortieren nach"),r.a.createElement(ce.a,{labelId:"demo-simple-select-placeholder-label-label",id:"demo-simple-select-placeholder-label",value:c,onChange:function(e){var t=e.target.value,n=o.find((function(e){return t===e.value}));n&&a(n)}},i))})),le=[{name:"Neueste",value:"newest"},{name:"Hottest",value:"hottest"}],me=function(e){Object(l.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:{},error:"",ordering:le[0]},e.handleOrderChange=function(t){e.setState({ordering:t})},e}return Object(s.a)(a,[{key:"setData",value:function(e){this.setState({data:e})}},{key:"componentDidMount",value:function(e){this.update()}},{key:"componentDidUpdate",value:function(e){this.props.refresh!==e.refresh&&this.update()}},{key:"update",value:function(){var e=this;fetch(T,F).then((function(e){return e.json()})).then((function(t){e.setData(t)}))}},{key:"render",value:function(){var e=this.props,t=e.user,a=e.classes,n=this.state,o=n.data,c=n.ordering,i=c.value,s=Object.entries(o).map((function(e){var t=Object(O.a)(e,2);return{id:t[0],data:t[1]}})).filter((function(e){return!0!==e.data.comment})).sort((function(e,t){if("newest"===i)return t.data.time-e.data.time;if("hottest"===i){var a=K(e.data.votes);return K(t.data.votes)-a}return 0})).map((function(e,a){return r.a.createElement(ne,{id:e.id,post:e.data,user:t,key:e.id})}));return r.a.createElement(h.a,{className:a.root,container:!0,spacing:1},r.a.createElement(h.a,{item:!0,xs:12},r.a.createElement(se,{ordering:c,orderings:le,onChange:this.handleOrderChange})),s)}}]),a}(r.a.Component),ue=Object(u.a)((function(e){return{root:{flexGrow:1}}}))(me),de=function(){return r.a.createElement("span",{role:"img","aria-label":"trompete",style:{margin:"1ex"}},"\ud83c\udfba")},fe=function(e){Object(l.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={refreshFeed:!1},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement("div",{className:t.root},r.a.createElement(d.a,{position:"static"},r.a.createElement(f.a,null,r.a.createElement(de,null),r.a.createElement(p.a,{variant:"h5",color:"inherit",className:t.flex},"Trompete"))),r.a.createElement(g.a,{square:!0,elevation:4,className:t.ui},r.a.createElement(h.a,{container:!0,spacing:2},r.a.createElement(h.a,{item:!0,xs:12},r.a.createElement(J,{user:"-M8qkGNG5pSfIyxBcxPP",onSend:function(t,a){e.setState((function(e){return{refreshFeed:!e.refreshFeed}}))}})))),r.a.createElement(h.a,{container:!0,spacing:2,className:t.main},r.a.createElement(h.a,{item:!0,xs:12},r.a.createElement(ue,{user:"-M8qkGNG5pSfIyxBcxPP",refresh:this.state.refreshFeed}))))}}]),a}(n.Component),pe=j(Object(u.a)((function(e){return{root:{flexGrow:1},main:{padding:e.spacing(2),margin:e.spacing(1)},ui:{padding:e.spacing(2),margin:e.spacing(1)}}}))(fe));c.a.render(r.a.createElement(pe,null),document.querySelector("#root"))}},[[84,1,2]]]);
//# sourceMappingURL=main.7d2660f1.chunk.js.map