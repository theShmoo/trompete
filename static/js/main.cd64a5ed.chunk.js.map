{"version":3,"sources":["withRoot.jsx","endpoints.jsx","postForm.jsx","utils.jsx","vote.jsx","post.jsx","orderingForm.jsx","feed.jsx","app.jsx","index.js"],"names":["theme","createMuiTheme","typography","useNextVariants","palette","primary","light","main","dark","contrastText","secondary","withRoot","Component","props","CssBaseline","PostsBase","PostsURL","GetRequestOptions","method","redirect","PostHeaderOptions","withStyles","form","flexGrow","button","margin","spacing","textField","padding","classes","user","onSend","React","useState","text","setText","done","setDone","error","setError","hasError","handleSend","msg","headers","body","JSON","stringify","Date","now","fetch","then","response","ok","json","catch","className","TextField","id","multiline","rowsMax","fullWidth","value","onKeyPress","ev","key","preventDefault","onChange","event","target","Button","variant","disabled","onClick","color","endIcon","Typography","VoteSum","votes","Object","entries","map","up","reduce","s","root","marginLeft","paddingLeft","icon","width","height","display","marginRight","justifyContent","alignItems","post","flatVotes","data","undefined","foundVote","find","v","vote","setVote","votesBase","handleVote","cVote","parse","time","url","Error","console","log","updateVote","name","initialVote","upcolor","downcolor","voteSum","Avatar","IconButton","aria-label","size","formatter","buildFormatter","germanStrings","Ago","Grid","item","xs","date","box","sm","lg","Paper","square","elevation","Box","formControl","minWidth","ordering","orderings","menus","o","i","MenuItem","FormControl","InputLabel","shrink","Select","labelId","found","possibleOrderings","Feed","state","handleOrderChange","setState","this","prevProps","update","refresh","setData","SortedPosts","sort","lhs","rhs","lvotes","container","TrompeteIcon","role","style","App","refreshFeed","AppBar","position","Toolbar","flex","ui","prevState","ReactDOM","render","document","querySelector"],"mappings":"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","file":"static/js/main.cd64a5ed.chunk.js","sourcesContent":["import React from 'react';\r\nimport { MuiThemeProvider, createMuiTheme } from '@material-ui/core/styles';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\n\r\n// A theme with custom primary and secondary color.\r\n// It's optional.\r\nconst theme = createMuiTheme({\r\n  typography: {\r\n    useNextVariants: true,\r\n  },\r\n  palette: {\r\n    primary: {\r\n      light: \"#99d066\",\r\n      main: \"#689f38\",\r\n      dark: \"#387002\",\r\n      contrastText: '#000'\r\n    },\r\n    secondary: {\r\n      light: \"#819ca9\",\r\n      main: \"#546e7a\",\r\n      dark: \"#29434e\",\r\n      contrastText: '#fff'\r\n    },\r\n  },\r\n});\r\n\r\nfunction withRoot(Component) {\r\n  function WithRoot(props) {\r\n    // MuiThemeProvider makes the theme available down the React tree\r\n    // thanks to React context.\r\n    return (\r\n      <MuiThemeProvider theme={theme}>\r\n        {/* CssBaseline kickstart an elegant, consistent, and simple baseline to build upon. */}\r\n        <CssBaseline />\r\n        <Component {...props} />\r\n      </MuiThemeProvider>\r\n    );\r\n  }\r\n\r\n  return WithRoot;\r\n}\r\n\r\nexport default withRoot;\r\n","export const PostsBase = 'https://lagerjodel.firebaseio.com/databases/posts';\r\nexport const PostsURL = PostsBase + '.json';\r\nexport const GetRequestOptions = {\r\n  method: 'GET',\r\n  redirect: 'follow'\r\n};\r\n\r\nexport const PostHeaderOptions = {\r\n  'Content-Type': 'application/json',\r\n  'Accept': 'application/json'\r\n}\r\n","import React from 'react';\r\n\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Button from '@material-ui/core/Button';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\nimport SendIcon from '@material-ui/icons/Send';\r\nimport DoneIcon from '@material-ui/icons/Done';\r\n\r\nimport { PostsURL, PostHeaderOptions } from './endpoints';\r\n\r\nconst styles = theme => ({\r\n  form: {\r\n    flexGrow: 1,\r\n  },\r\n  button: {\r\n    margin: theme.spacing(1),\r\n  },\r\n  textField: {\r\n    flexGrow: 1,\r\n    padding: theme.spacing(2),\r\n  },\r\n});\r\n\r\nconst PostForm = (props) => {\r\n  const { classes, user, onSend } = props;\r\n  const [text, setText] = React.useState('');\r\n  const [done, setDone] = React.useState(false);\r\n  const [error, setError] = React.useState(\"Leere Trompete\");\r\n  const hasError = error !== \"\"\r\n\r\n  const wrappedOnSend = () => {\r\n    onSend();\r\n  };\r\n\r\n  const handleSend = () => {\r\n    if (hasError) return;\r\n\r\n    const msg = {\r\n      method: 'POST',\r\n      headers: PostHeaderOptions,\r\n      body: JSON.stringify({\r\n        'user': user,\r\n        'text': text,\r\n        'time': Date.now()\r\n      }),\r\n      redirect: 'follow'\r\n    };\r\n    fetch(PostsURL, msg)\r\n      .then((response) => {\r\n        if (response.ok) {\r\n          response.json().then((json) => {\r\n            setDone(true);\r\n            setText(\"\");\r\n            wrappedOnSend();\r\n          }).catch(() => {\r\n            setError(\"Fehler beim Verarbeiten der Nachricht...\");\r\n          });\r\n        }\r\n        else {\r\n          setError(\"Mein Server mag diese Nachricht nicht...\");\r\n        }\r\n      })\r\n      // this would recover the error message\r\n      //.then( data => setError(\"sending failed...\" + data.errors[0].msg))\r\n      .catch(() => {\r\n        setError(\"Fehler beim Senden der Nachricht...\");\r\n      });\r\n  };\r\n\r\n  const handleChange = (event) => {\r\n    if (done) {\r\n      setDone(false);\r\n    }\r\n    setText(event.target.value);\r\n    setError(event.target.value ? \"\" : \"Leere Trompete\");\r\n  };\r\n\r\n  return <form className={classes.form}>\r\n    <TextField\r\n      id=\"my-text\"\r\n      multiline\r\n      error={hasError}\r\n      className={classes.textField}\r\n      rowsMax={4}\r\n      fullWidth\r\n      value={text}\r\n      onKeyPress={(ev) => {\r\n        if (ev.key === 'Enter') {\r\n          handleSend();\r\n          ev.preventDefault();\r\n        }\r\n      }}\r\n      onChange={handleChange}\r\n    />\r\n    <Button\r\n      variant=\"contained\"\r\n      disabled={done || hasError}\r\n      onClick={handleSend}\r\n      className={classes.button}\r\n      color={done ? \"secondary\" : \"primary\"}\r\n      endIcon={done ? <DoneIcon /> : <SendIcon />}>\r\n      Send\r\n          </Button>\r\n    {done ? <Typography variant=\"body1\" color=\"primary\">Gesendet!</Typography> : \"\"}\r\n  </form>\r\n};\r\n\r\nexport default withStyles(styles)(PostForm);\r\n","export function VoteSum(votes) {\r\n  if (votes) {\r\n    const ups = Object.entries(votes).map(\r\n      ([, v]) => { return v.up });\r\n    return ups.reduce((s, up) => s + (up ? 1 : -1), 0);\r\n  }\r\n  return 0;\r\n}\r\n","import React from 'react';\r\n\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\nimport ArrowUpwardIcon from '@material-ui/icons/ArrowUpward';\r\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\r\n\r\nimport { PostsBase, PostHeaderOptions } from './endpoints';\r\nimport { VoteSum } from './utils';\r\n\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    marginLeft: 'auto',\r\n    paddingLeft: theme.spacing(1)\r\n  },\r\n  icon: {\r\n    width: theme.spacing(3),\r\n    height: theme.spacing(3),\r\n    display: 'block',\r\n    marginLeft: 'auto',\r\n    marginRight: 'auto',\r\n  },\r\n  votes: {\r\n    height: '100%',\r\n    display: 'flex',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  }\r\n});\r\n\r\nconst Votes = (props) => {\r\n  const { id, post, user, classes } = props;\r\n  const { votes } = post;\r\n  const flatVotes = votes ? Object.entries(votes).map(\r\n    ([k, v]) => { return { id: k, data: v } }) : undefined;\r\n  const foundVote = flatVotes ? flatVotes.find(v => v.data.user === user) : undefined;\r\n\r\n  const [vote, setVote] = React.useState(foundVote);\r\n\r\n  const votesBase = PostsBase + '/' + id + '/votes';\r\n\r\n\r\n  const initialVote = (data, up) => {\r\n    const url = votesBase + '.json';\r\n    const msg = {\r\n      method: 'POST',\r\n      headers: PostHeaderOptions,\r\n      body: JSON.stringify(data),\r\n      redirect: 'follow'\r\n    };\r\n    fetch(url, msg)\r\n      .then((response) => {\r\n        if (response.ok) {\r\n          response.json().then((json) => {\r\n            setVote({\r\n              data: data,\r\n              id: json.name\r\n            });\r\n          });\r\n        }\r\n        else {\r\n          throw new Error(\"Whoops!\");\r\n        }\r\n      })\r\n      .catch(() => {\r\n        console.log(\"Fehler beim Senden des Votes...\");\r\n      });\r\n  }\r\n\r\n  const updateVote = (data, up) => {\r\n    const url = votesBase + '/' + vote.id + '/.json';\r\n    const msg = {\r\n      method: 'PATCH',\r\n      headers: PostHeaderOptions,\r\n      body: JSON.stringify(data),\r\n      redirect: 'follow'\r\n    };\r\n    fetch(url, msg)\r\n      .then((response) => {\r\n        if (response.ok) {\r\n          // good\r\n        }\r\n        else {\r\n          throw new Error(\"Whoops!\");\r\n        }\r\n      })\r\n      .catch(() => {\r\n        console.log(\"Fehler beim Senden des Votes...\");\r\n      });\r\n  }\r\n\r\n  const handleVote = (up) => {\r\n    if (vote) {\r\n      // if the vote does not have an id yet we just ignore it\r\n      // also we ignore it if the vote has the same up state\r\n      if (vote.id && vote.data.up !== up) {\r\n        const cVote = JSON.parse(JSON.stringify(vote))\r\n        cVote.data.up = up;\r\n        cVote.data.time = Date.now();\r\n        setVote(cVote);\r\n        updateVote(cVote.data, up);\r\n      }\r\n    }\r\n    else {\r\n      const data = {\r\n        'user': user,\r\n        'up': up,\r\n        'time': Date.now()\r\n      }\r\n      setVote({ data: data });\r\n      initialVote(data, up);\r\n    }\r\n  };\r\n\r\n  const handleUpVote = (event) => {\r\n    handleVote(true);\r\n  }\r\n\r\n  const handleDownVote = (event) => {\r\n    handleVote(false);\r\n  }\r\n  let upcolor = \"inherit\";\r\n  let downcolor = \"inherit\";\r\n  let voteSum = VoteSum(votes);\r\n  if (vote) {\r\n    const { up } = vote.data;\r\n    upcolor = up ? \"primary\" : \"inherit\";\r\n    downcolor = !up ? \"primary\" : \"inherit\";\r\n    // correct the voting by the local state\r\n    if (foundVote) {\r\n      if (foundVote.data.up !== up) {\r\n        voteSum += up ? 2 : -2;\r\n      }\r\n    }\r\n    else {\r\n      voteSum += up ? 1 : -1;\r\n    }\r\n  }\r\n\r\n  return <div className={classes.root}>\r\n    <Avatar className={classes.icon}>\r\n      <Typography variant=\"caption\" className={classes.votes}>\r\n        {voteSum}\r\n      </Typography>\r\n    </Avatar>\r\n    <IconButton\r\n      className={classes.icon}\r\n      aria-label=\"upvote\"\r\n      size=\"small\"\r\n      color={upcolor}\r\n      onClick={handleUpVote}>\r\n      <ArrowUpwardIcon />\r\n    </IconButton>\r\n    <IconButton\r\n      className={classes.icon}\r\n      aria-label=\"downvote\"\r\n      size=\"small\"\r\n      color={downcolor}\r\n      onClick={handleDownVote}>\r\n      <ArrowDownwardIcon />\r\n    </IconButton>\r\n  </div>\r\n};\r\n\r\nexport default withStyles(styles)(Votes);\r\n\r\n\r\n","import React from 'react';\r\n\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport Box from '@material-ui/core/Box';\r\nimport TimeAgo from 'react-timeago'\r\nimport germanStrings from 'react-timeago/lib/language-strings/de'\r\nimport buildFormatter from 'react-timeago/lib/formatters/buildFormatter'\r\n\r\nimport Vote from './vote';\r\n\r\nconst formatter = buildFormatter(germanStrings);\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    flexGrow: 1,\r\n  },\r\n  box: {\r\n    margin: theme.spacing(1),\r\n    padding: theme.spacing(2),\r\n  }\r\n});\r\n\r\nconst Ago = (props) => {\r\n  return <Grid item xs={12}>\r\n    <Typography variant=\"caption\" color=\"inherit\">\r\n      <TimeAgo date={props.time} formatter={formatter} />\r\n    </Typography>\r\n  </Grid>\r\n}\r\n\r\nconst Post = (props) => {\r\n  const { id, post, user, classes } = props;\r\n  const { text, time } = post;\r\n\r\n  return <Grid item xs={12} sm={6} lg={4} className={classes.root}>\r\n    <Paper square elevation={2} className={classes.box}>\r\n      <Box display=\"flex\" >\r\n        <Typography variant=\"h6\" color=\"inherit\">\r\n          {text}\r\n        </Typography>\r\n        <Vote post={post} id={id} user={user} />\r\n      </Box>\r\n      <Ago time={time} />\r\n    </Paper>\r\n  </Grid>\r\n};\r\n\r\nexport default withStyles(styles)(Post);\r\n\r\n","\r\nimport React from 'react';\r\n\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Select from '@material-ui/core/Select';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\n\r\n\r\nconst styles = theme => ({\r\n  formControl: {\r\n    margin: theme.spacing(1),\r\n    minWidth: 120,\r\n  }\r\n});\r\n\r\nconst OrderingForm = (props) => {\r\n  const { classes, onChange, ordering, orderings } = props;\r\n  const { value } = ordering;\r\n\r\n  const menus = orderings.map((o, i) => {\r\n    return <MenuItem value={o.value} key={i}>{o.name}</MenuItem>\r\n  });\r\n\r\n  const handleChange = (event) => {\r\n    const { value } = event.target;\r\n    const found = orderings.find(o => value === o.value);\r\n    if (found)\r\n      onChange(found);\r\n  };\r\n\r\n  return <FormControl className={classes.formControl}>\r\n    <InputLabel shrink id=\"ordering-label\">\r\n      sortieren nach\r\n    </InputLabel>\r\n    <Select\r\n      labelId=\"demo-simple-select-placeholder-label-label\"\r\n      id=\"demo-simple-select-placeholder-label\"\r\n      value={value}\r\n      onChange={handleChange}\r\n    >\r\n      {menus}\r\n    </Select>\r\n  </FormControl>\r\n};\r\n\r\nexport default withStyles(styles)(OrderingForm);\r\n","import React from 'react';\r\n\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport Grid from '@material-ui/core/Grid';\r\n\r\nimport Post from './post';\r\nimport OrderingForm from './orderingForm';\r\nimport { PostsURL, GetRequestOptions } from './endpoints';\r\nimport { VoteSum } from './utils';\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    flexGrow: 1,\r\n  },\r\n});\r\n\r\nconst possibleOrderings = [\r\n  { name: \"Neueste\", value: \"newest\" },\r\n  { name: \"Hottest\", value: \"hottest\" },\r\n]\r\n\r\nclass Feed extends React.Component {\r\n  state = {\r\n    data: {},\r\n    error: \"\",\r\n    ordering: possibleOrderings[0]\r\n  }\r\n\r\n  setData(data) {\r\n    this.setState({ data: data });\r\n  }\r\n\r\n  componentDidMount(prevProps) {\r\n    this.update()\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (this.props.refresh !== prevProps.refresh) {\r\n      this.update()\r\n    }\r\n  }\r\n\r\n  handleOrderChange = (ordering) => {\r\n    this.setState({ ordering: ordering });\r\n  }\r\n\r\n  update() {\r\n    // const { user } = this.props;\r\n    fetch(PostsURL, GetRequestOptions).then(response => response.json())\r\n      .then(json => {\r\n        this.setData(json);\r\n      });\r\n  }\r\n\r\n  render() {\r\n    const { user, classes } = this.props;\r\n    const { data, ordering } = this.state;\r\n    const { value } = ordering;\r\n    const FlatPosts = Object.entries(data).map(([k, v]) => { return { id: k, data: v }; });\r\n    const SortedPosts = FlatPosts.sort((lhs, rhs) => {\r\n      if (value === \"newest\") {\r\n        return rhs.data.time - lhs.data.time;\r\n      }\r\n      else if (value === \"hottest\") {\r\n        const lvotes = VoteSum(lhs.data.votes);\r\n        const rvotes = VoteSum(rhs.data.votes);\r\n        const score = rvotes - lvotes;\r\n        return score;\r\n      }\r\n      else {\r\n        return 0;\r\n      }\r\n    }).map((post, i) => {\r\n      return <Post id={post.id} post={post.data} user={user} key={post.id} />\r\n    });\r\n\r\n    return <Grid className={classes.root} container spacing={1}>\r\n      <Grid item xs={12}>\r\n        <OrderingForm ordering={ordering} orderings={possibleOrderings} onChange={this.handleOrderChange} />\r\n      </Grid>\r\n      {SortedPosts}\r\n    </Grid>\r\n  }\r\n};\r\n\r\nexport default withStyles(styles)(Feed);\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Paper from '@material-ui/core/Paper';\r\n\r\nimport withRoot from './withRoot';\r\nimport PostForm from './postForm';\r\nimport Feed from './feed';\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    flexGrow: 1,\r\n  },\r\n  main: {\r\n    padding: theme.spacing(2),\r\n    margin: theme.spacing(1),\r\n  },\r\n  ui: {\r\n    padding: theme.spacing(2),\r\n    margin: theme.spacing(1),\r\n  },\r\n});\r\n\r\nconst TrompeteIcon = () => { return <span role=\"img\" aria-label=\"trompete\" style={{ margin: \"1ex\" }}>🎺</span>; };\r\n\r\nconst user = '-M8qkGNG5pSfIyxBcxPP';\r\n\r\nclass App extends Component {\r\n\r\n  state = {\r\n    refreshFeed: false\r\n  };\r\n\r\n  render() {\r\n    const { classes } = this.props;\r\n\r\n    const handleSend = () => { this.setState(prevState => { return { refreshFeed: !prevState.refreshFeed } }); };\r\n\r\n    return <div className={classes.root}>\r\n      <AppBar position=\"static\">\r\n        <Toolbar>\r\n          <TrompeteIcon />\r\n          <Typography variant=\"h6\" color=\"inherit\" className={classes.flex}>\r\n            Trompete\r\n          </Typography>\r\n        </Toolbar>\r\n      </AppBar>\r\n      <Paper square elevation={4} className={classes.ui}>\r\n        <Grid container spacing={2}>\r\n          <Grid item xs={12}>\r\n            <PostForm user={user} onSend={handleSend} />\r\n          </Grid>\r\n        </Grid>\r\n      </Paper>\r\n      <Grid container spacing={2} className={classes.main}>\r\n        <Grid item xs={12}>\r\n          <Feed user={user} refresh={this.state.refreshFeed} />\r\n        </Grid>\r\n      </Grid>\r\n    </div >\r\n  }\r\n}\r\n\r\nApp.propTypes = {\r\n  classes: PropTypes.object.isRequired,\r\n};\r\n\r\nexport default withRoot(withStyles(styles)(App));\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './app.jsx';\r\n\r\nReactDOM.render(<App />, document.querySelector('#root'));\r\n"],"sourceRoot":""}