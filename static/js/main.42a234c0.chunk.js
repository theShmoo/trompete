(this.webpackJsonptrompete=this.webpackJsonptrompete||[]).push([[0],{80:function(e,t,a){e.exports=a(91)},91:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(8),o=a.n(i),c=a(38),s=a(39),l=a(50),u=a(49),m=a(4),d=a(133),f=a(134),h=a(130),p=a(132),v=a(93),g=a(67),b=a(122),E=a(123),y=Object(g.a)({typography:{useNextVariants:!0},palette:{primary:{light:"#99d066",main:"#689f38",dark:"#387002",contrastText:"#000"},secondary:{light:"#819ca9",main:"#546e7a",dark:"#29434e",contrastText:"#fff"}}});var j=function(e){return function(t){return r.a.createElement(b.a,{theme:y},r.a.createElement(E.a,null),r.a.createElement(e,t))}},O=a(13),x=a(138),N=a(129),w=a(61),S=a.n(w),k=a(60),C=a.n(k),G="https://lagerjodel.firebaseio.com/databases/posts",F=G+".json",T={method:"GET",redirect:"follow"},D={"Content-Type":"application/json",Accept:"application/json"},P=Object(m.a)((function(e){return{form:{flexGrow:1},button:{margin:e.spacing(1)},textField:{flexGrow:1,padding:e.spacing(2)}}}))((function(e){var t=e.classes,a=e.user,n=e.onSend,i=r.a.useState(""),o=Object(O.a)(i,2),c=o[0],s=o[1],l=r.a.useState(!1),u=Object(O.a)(l,2),m=u[0],d=u[1],f=r.a.useState("Leere Trompete"),p=Object(O.a)(f,2),v=p[0],g=p[1],b=""!==v,E=function(){if(!b){var e={method:"POST",headers:D,body:JSON.stringify({user:a,text:c,time:Date.now()}),redirect:"follow"};fetch(F,e).then((function(e){e.ok?e.json().then((function(e){d(!0),s(""),n()})).catch((function(){g("Fehler beim Verarbeiten der Nachricht...")})):g("Mein Server mag diese Nachricht nicht...")})).catch((function(){g("Fehler beim Senden der Nachricht...")}))}};return r.a.createElement("form",{className:t.form},r.a.createElement(x.a,{id:"my-text",multiline:!0,error:b,className:t.textField,rowsMax:4,fullWidth:!0,value:c,onKeyPress:function(e){"Enter"===e.key&&(E(),e.preventDefault())},onChange:function(e){m&&d(!1),s(e.target.value),g(e.target.value?"":"Leere Trompete")}}),r.a.createElement(N.a,{variant:"contained",disabled:m||b,onClick:E,className:t.button,color:m?"secondary":"primary",endIcon:m?r.a.createElement(C.a,null):r.a.createElement(S.a,null)},"Send"),m?r.a.createElement(h.a,{variant:"body1",color:"primary"},"Gesendet!"):"")})),J=a(137),q=a(62),I=a.n(q),L=a(63),M=a.n(L),A=a(64),V=a.n(A),W=a(143),z=a(131),B=a(65),H=a.n(B),K=a(66),R=a.n(K);function U(e){return e?Object.entries(e).map((function(e){return Object(O.a)(e,2)[1].up})).reduce((function(e,t){return e+(t?1:-1)}),0):0}var Q=Object(m.a)((function(e){return{root:{marginLeft:"auto",paddingLeft:e.spacing(1)},icon:{width:e.spacing(3),height:e.spacing(3),display:"block",marginLeft:"auto",marginRight:"auto"},votes:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}}}))((function(e){var t=e.id,a=e.post,n=e.user,i=e.classes,o=a.votes,c=o?Object.entries(o).map((function(e){var t=Object(O.a)(e,2);return{id:t[0],data:t[1]}})):void 0,s=c?c.find((function(e){return e.data.user===n})):void 0,l=r.a.useState(s),u=Object(O.a)(l,2),m=u[0],d=u[1],f=G+"/"+t+"/votes",p=function(e){if(m){if(m.id&&m.data.up!==e){var t=JSON.parse(JSON.stringify(m));t.data.up=e,t.data.time=Date.now(),d(t),function(e,t){var a=f+"/"+m.id+"/.json",n={method:"PATCH",headers:D,body:JSON.stringify(e),redirect:"follow"};fetch(a,n).then((function(e){if(!e.ok)throw new Error("Whoops!")})).catch((function(){console.log("Fehler beim Senden des Votes...")}))}(t.data)}}else{var a={user:n,up:e,time:Date.now()};d({data:a}),function(e,t){var a=f+".json",n={method:"POST",headers:D,body:JSON.stringify(e),redirect:"follow"};fetch(a,n).then((function(t){if(!t.ok)throw new Error("Whoops!");t.json().then((function(t){d({data:e,id:t.name})}))})).catch((function(){console.log("Fehler beim Senden des Votes...")}))}(a)}},v="inherit",g="inherit",b=U(o);if(m){var E=m.data.up;v=E?"primary":"inherit",g=E?"inherit":"primary",s?s.data.up!==E&&(b+=E?2:-2):b+=E?1:-1}return r.a.createElement("div",{className:i.root},r.a.createElement(W.a,{className:i.icon},r.a.createElement(h.a,{variant:"caption",className:i.votes},b)),r.a.createElement(z.a,{className:i.icon,"aria-label":"upvote",size:"small",color:v,onClick:function(e){p(!0)}},r.a.createElement(H.a,null)),r.a.createElement(z.a,{className:i.icon,"aria-label":"downvote",size:"small",color:g,onClick:function(e){p(!1)}},r.a.createElement(R.a,null)))})),X=V()(M.a),Y=function(e){return r.a.createElement(p.a,{xs:12},r.a.createElement(h.a,{variant:"caption",color:"inherit"},r.a.createElement(I.a,{date:e.time,formatter:X})))},Z=Object(m.a)((function(e){return{root:{flexGrow:1},box:{margin:e.spacing(1),padding:e.spacing(2)}}}))((function(e){var t=e.id,a=e.post,n=e.user,i=e.classes,o=a.text,c=a.time;return r.a.createElement(p.a,{item:!0,xs:12,sm:6,lg:4,className:i.root},r.a.createElement(v.a,{square:!0,elevation:2,className:i.box},r.a.createElement(J.a,{display:"flex"},r.a.createElement(h.a,{variant:"h6",color:"inherit"},o),r.a.createElement(Q,{post:a,id:t,user:n})),r.a.createElement(Y,{time:c})))})),$=a(128),_=a(140),ee=a(135),te=a(139),ae=Object(m.a)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120}}}))((function(e){var t=e.classes,a=e.onChange,n=e.ordering,i=e.orderings,o=n.value,c=i.map((function(e){return r.a.createElement(_.a,{value:e.value},e.name)}));return r.a.createElement($.a,{className:t.formControl},r.a.createElement(te.a,{shrink:!0,id:"ordering-label"},"sortieren nach"),r.a.createElement(ee.a,{labelId:"demo-simple-select-placeholder-label-label",id:"demo-simple-select-placeholder-label",value:o,onChange:function(e){var t=e.target.value,n=i.find((function(e){return t===e.value}));n&&a(n)}},c))})),ne=[{name:"Neueste",value:"newest"},{name:"Hottest",value:"hottest"}],re=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={data:{},error:"",ordering:ne[0]},e.handleOrderChange=function(t){e.setState({ordering:t})},e}return Object(s.a)(a,[{key:"setData",value:function(e){this.setState({data:e})}},{key:"componentDidMount",value:function(e){this.update()}},{key:"componentDidUpdate",value:function(e){this.props.refresh!==e.refresh&&this.update()}},{key:"update",value:function(){var e=this;fetch(F,T).then((function(e){return e.json()})).then((function(t){e.setData(t)}))}},{key:"render",value:function(){var e=this.props,t=e.user,a=e.classes,n=this.state,i=n.data,o=n.ordering,c=o.value,s=Object.entries(i).map((function(e){var t=Object(O.a)(e,2);return{id:t[0],data:t[1]}})).sort((function(e,t){if("newest"===c)return t.data.time-e.data.time;if("hottest"===c){var a=U(e.data.votes);return U(t.data.votes)-a}return 0})).map((function(e,a){return r.a.createElement(Z,{id:e.id,post:e.data,user:t,key:a})}));return r.a.createElement(p.a,{className:a.root,container:!0,spacing:1},r.a.createElement(p.a,{item:!0,xs:12},r.a.createElement(ae,{ordering:o,orderings:ne,onChange:this.handleOrderChange})),s)}}]),a}(r.a.Component),ie=Object(m.a)((function(e){return{root:{flexGrow:1}}}))(re),oe=function(){return r.a.createElement("span",{role:"img","aria-label":"trompete",style:{margin:"1ex"}},"\ud83c\udfba")},ce=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={refreshFeed:!1},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement("div",{className:t.root},r.a.createElement(d.a,{position:"static"},r.a.createElement(f.a,null,r.a.createElement(oe,null),r.a.createElement(h.a,{variant:"h6",color:"inherit",className:t.flex},"Trompete"))),r.a.createElement(v.a,{square:!0,elevation:4,className:t.ui},r.a.createElement(p.a,{container:!0,spacing:2},r.a.createElement(p.a,{item:!0,xs:12},r.a.createElement(P,{user:"-M8qkGNG5pSfIyxBcxPP",onSend:function(){e.setState((function(e){return{refreshFeed:!e.refreshFeed}}))}})))),r.a.createElement(p.a,{container:!0,spacing:2,className:t.main},r.a.createElement(p.a,{item:!0,xs:12},r.a.createElement(ie,{user:"-M8qkGNG5pSfIyxBcxPP",refresh:this.state.refreshFeed}))))}}]),a}(n.Component),se=j(Object(m.a)((function(e){return{root:{flexGrow:1},main:{padding:e.spacing(2),margin:e.spacing(1)},ui:{padding:e.spacing(2),margin:e.spacing(1)}}}))(ce));o.a.render(r.a.createElement(se,null),document.querySelector("#root"))}},[[80,1,2]]]);
//# sourceMappingURL=main.42a234c0.chunk.js.map